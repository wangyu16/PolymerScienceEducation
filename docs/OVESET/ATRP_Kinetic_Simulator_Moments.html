<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>atrp_kinetic_simulator_moments – OVESET</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-3a01e2046221230fdceeea94b1ec5d67.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-4cacd32a1fd9244ec1eef8abc16e8cc9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">OVESET</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../fqa.html"> 
<span class="menu-text">FQA</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/M01_MWD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 1 Molecular Weight Distribution</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/M02_Step.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 2 Step Growth Polymerization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/M03_ConvenRad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 3 Conventional Radical Polymerization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/M04_ATRP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 4 Atom Transfer Radical Polymerization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/M05_RadCopoly.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 5 Radical Copolymerization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/M06_Network.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 6 Network formation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/M07_SingleChain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 7 Single chain conformation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/M08_SelfAvoid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 8 Self-avoid chains</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/M09_StarBranch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 9 Star and branched polymers</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#about-this-program" id="toc-about-this-program" class="nav-link active" data-scroll-target="#about-this-program">About this program</a></li>
  <li><a href="#import-packages" id="toc-import-packages" class="nav-link" data-scroll-target="#import-packages">1. Import packages</a></li>
  <li><a href="#reaction-conditions" id="toc-reaction-conditions" class="nav-link" data-scroll-target="#reaction-conditions">2. Reaction conditions</a></li>
  <li><a href="#construct-the-reaction-system" id="toc-construct-the-reaction-system" class="nav-link" data-scroll-target="#construct-the-reaction-system">3. Construct the reaction system</a></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">4. Simulation</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">5. Results</a>
  <ul class="collapse">
  <li><a href="#concentration-changes" id="toc-concentration-changes" class="nav-link" data-scroll-target="#concentration-changes">5.1. Concentration changes</a></li>
  <li><a href="#monomer-conversion-vs-time" id="toc-monomer-conversion-vs-time" class="nav-link" data-scroll-target="#monomer-conversion-vs-time">5.2. Monomer conversion vs time</a></li>
  <li><a href="#molecular-weight-molecular-weight-distribution-and-mole-percent-loss-of-chain-ends." id="toc-molecular-weight-molecular-weight-distribution-and-mole-percent-loss-of-chain-ends." class="nav-link" data-scroll-target="#molecular-weight-molecular-weight-distribution-and-mole-percent-loss-of-chain-ends.">5.3. Molecular weight, molecular weight distribution and mole percent loss of chain-ends.</a></li>
  </ul></li>
  <li><a href="#export-the-results" id="toc-export-the-results" class="nav-link" data-scroll-target="#export-the-results">6. Export the results</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<center>
<img src="https://raw.githubusercontent.com/wangyu16/PolymerScienceEducation/master/Fig/Logo_black.svg" width="150">
</center>
#
<center>
ATRP Kinetic Simulator - by the Method of Moments
</center>
<center>
12/28/2021
</center>
<hr>
<section id="about-this-program" class="level2">
<h2 class="anchored" data-anchor-id="about-this-program">About this program</h2>
<p>This is an atom transfer radical polymerization (ATRP) kinetic simulator based on the method of moments.[1,2] The types of polymerizations supported are conventional radical polymerization, normal atom transfer radical polymerization, activators generated by electron transfer (AGET) ATRP, activators regenerated by electron transfer (ARGET) ATRP, supplemental activator and reducing agent (SARA) ATRP, electrochemically mediated ATRP (<em>e</em>ATRP), ATRP by continuous feeding of activators (CFA), and initiators for continuous activator regeneration (ICAR) ATRP. The input includes the reaction time, the initial concentrations of reagents, and the rate coefficients of all reactions involved. The results provide the concentration changes of all species vs.&nbsp;time, the monomer conversion vs.&nbsp;time, the number average molecular weight (<span class="math inline">\(M_n\)</span>) vs.&nbsp;time, molecular weight distribution (<span class="math inline">\(M_w/M_n\)</span>) vs.&nbsp;time, and the mole percent of end group loss (<span class="math inline">\(T_\text{mol%}\)</span>) vs.&nbsp;time.</p>
<p>[1]: Shiping Zhu, Modeling of molecular weight development in atom transfer radical polymerization, <em>Macromol. Theory Simul.</em> <strong>1999</strong>, <em>8</em>, 29–37, <a href="https://doi.org/10.1002/(SICI)1521-3919(19990101)8:1%3C29::AID-MATS29%3E3.0.CO;2-7">DOI: 10.1002/(SICI)1521-3919(19990101)8:1&lt;29::AID-MATS29&gt;3.0.CO;2-7</a>.<br>
[2]: Erlita Mastan and Shiping Zhu, Method of moments: A versatile tool for deterministic modeling of polymerization kinetics, <em>Eur. Polym. J.</em> <strong>2015</strong>, <em>68</em>, 139–160, <a href="https://doi.org/10.1016/j.eurpolymj.2015.04.018">DOI: 10.1016/j.eurpolymj.2015.04.018</a>.</p>
<p><strong>System requirement</strong></p>
<p><em>a. To run this program online using Google Colaboratory service</em></p>
<p>As long as you have a google account, you can use this simulator as an online app without installing anything to your local computer. This program is available freely at <a href="https://bit.ly/ATRP-Simulator">https://bit.ly/ATRP-Simulator</a>.</p>
<p><em>b. To deploy a modified version online</em></p>
<p>Instructors may want to modify this program and deploy it online, so your students can use the modified program as an online app. To do so, download this “ATRP_Kinetic_Simulator_Moments.ipynb” file at <a href="https://github.com/wangyu16/PolymerScienceEducation/tree/master/OVESET">https://github.com/wangyu16/PolymerScienceEducation/tree/master/OVESET</a>; then modify it and place the modified version into your Google Drive or GitHub. Next, go to https://colab.research.google.com/ and open the program you just saved in Google Drive or GitHub. Finally, in the top-right corner, you can find the options for sharing this program.</p>
<p><em>c.&nbsp;To run this program on your own computer</em></p>
<p>This program is written in Python and runs in Jupyter Notebook. The easiest way to set up the Jupyter Notebook is to install <a href="https://www.anaconda.com/distribution/">Anaconda</a> which includes python, Jupyter Notebook, and many python packages for scientific programming. Make sure you choose Python 3.6 or above because it is required for this program. After installing Anaconda, you also need to install a python package named <a href="https://pypi.org/project/chempy/">‘ChemPy’</a>. If you use Linux, the simplest way to install ChemPy is to use the conda package manager:</p>
<pre class="shell"><code>conda install -c bjodah chempy pytest
pytest -rs -W ignore::chempy.ChemPyDeprecationWarning --pyargs chempy  </code></pre>
<p>If you use Windows or OS X, you will need to use pip instead. Open “Anaconda Prompt” and type:</p>
<pre class="shell"><code>python3 -m pip install chempy pytest
python3 -m pytest -rs -W ignore::chempy.ChemPyDeprecationWarning --pyargs chempy</code></pre>
<p>After installation of Anaconda, Jupyter Notebook should appear as an app on your computer. Click on the icon of Jupyter Notebook and it will open a new tab in your browser. Download this “ATRP_Kinetic_Simulator_Moments.ipynb” file at <a href="https://github.com/wangyu16/PolymerScienceEducation/tree/master/OVESET">https://github.com/wangyu16/PolymerScienceEducation/tree/master/OVESET</a>, and navigate to the folder where you save it. Click on it and open it.</p>
<p><strong>Not sure what you can change in the code?</strong></p>
<p>No worries! If you are not familiar with programming, all that you may change are located in the section “<strong>2. Reaction conditions</strong>”. For example, in the following code block, you can change the red-colored word ‘normal’, and the green-colored number 90000.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 'sara' for SARA ATRP;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 'cfa' for ATRP by continuous feeding of activators;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 'icar' for ICAR ATRP.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Poly_type <span class="op">=</span> <span class="st">'normal'</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">############################    </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Set the reaction time #</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">############################ </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a required section.</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set reaction time limit in seconds. </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>react_time <span class="op">=</span> <span class="dv">90000</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Similarly, in the following code, only change the green-colored numbers.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the rate coefficients for the addition of the first monomer to the primary radical;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the termination between primary radicals; the termination between a primary radical and a propagating radical. </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>k_p_R <span class="op">=</span> <span class="fl">1.3e3</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>k_t_R <span class="op">=</span> <span class="fl">1e9</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>k_t_R_Pn <span class="op">=</span> <span class="fl">1e9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In addition, you can change the font size of the plots under “<strong>1. Import packages</strong>” and “<strong>5.1. Concentration changes</strong>”. Change the green-colored numbers only in the following code lines.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'font.size'</span>: <span class="dv">18</span>}) <span class="co"># Feel free to change the font size in the plots.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>     _ <span class="op">=</span> ax.legend(loc<span class="op">=</span><span class="st">'best'</span>,prop<span class="op">=</span>{<span class="st">'size'</span>: <span class="dv">12</span>}) <span class="co"># Set the font size of the legend here. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>How to run the simulation?</strong></p>
<p>After specifying the initial reaction conditions, move to the first code cell, i.e., the one under “<strong>1. Import packages</strong>”. Run the code cells one-by-one by using <kbd>Shift</kbd>+<kbd>Enter</kbd>. Alternatively, you can select “Run All” under “Cell” dropdown menu if you use Anaconda, or under “Runtime” dropdown menu if you use Google Colab.</p>
<hr>
</section>
<section id="import-packages" class="level2">
<h2 class="anchored" data-anchor-id="import-packages">1. Import packages</h2>
<div id="cell-4" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>capture</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#@title { display-mode: "form" } </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'google.colab'</span> <span class="kw">in</span> sys.modules: </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="st">'chempy'</span> <span class="kw">in</span> sys.modules:</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">!</span>pip install chempy</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> chempy <span class="im">import</span> ReactionSystem, Substance</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> chempy.kinetics.ode <span class="im">import</span> get_odesys </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'font.size'</span>: <span class="dv">12</span>}) <span class="co"># Feel free to change the font size in the plots.</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipywidgets <span class="im">import</span> interact</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reaction-conditions" class="level2">
<h2 class="anchored" data-anchor-id="reaction-conditions">2. Reaction conditions</h2>
<div id="cell-6" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">##################################</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Select the type of reaction # </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a required section.    #</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">##################################</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose the type of polymerization you want to simulate</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># by setting the value of Poly_type as:</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 'conven' for conventional radical polymerization initiated by a thermal initiator, such as AIBN;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 'normal' for normal ATRP;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 'arget' for ARGET and AGET ATRP;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 'eatrp' for electrochemically mediated ATRP;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 'sara' for SARA ATRP;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 'cfa' for ATRP by continuous feeding of activators;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 'icar' for ICAR ATRP. </span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>Poly_type <span class="op">=</span> <span class="st">'normal'</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">############</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional #</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">############</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>Monomer <span class="op">=</span> <span class="st">'MA'</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>Solvent <span class="op">=</span> <span class="st">'MeCN'</span> <span class="co"># For bulk polymerization, the value can be set as 'none'.</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>Ligand <span class="op">=</span> <span class="st">'TPMA'</span> <span class="co"># For conventional radical polymerization, this value could be set as 'none'.</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>Initiator <span class="op">=</span> <span class="st">'MBrP'</span> <span class="co"># For ICAR ATRP, this value could be set in the form of 'EBrP-AIBN'.</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>Temperature <span class="op">=</span> <span class="dv">60</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co"># The name of the monomer, ligand, initiator ,and the temperature will not be used in the simulation.</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co"># They are used only as a record in the exported file. </span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co">##############################    </span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Set the reaction time   #</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a required section.#</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co">##############################</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Set reaction time limit in seconds. </span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co"># For a 10 hour reaction, you can set the time as 36000 or 10*3600.</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>react_time <span class="op">=</span> <span class="dv">5</span><span class="op">*</span><span class="dv">3600</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co">###########################################################</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Set the initial concentrations and rate coefficients #</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co">###########################################################</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co">##############################</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.1. Monomer concentration #</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a required section.#</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="co">##############################</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the initial concentration of the monomer. All the concentrations are in mol/L unless otherwise specified.</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>c0_M <span class="op">=</span> <span class="fl">5.5</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the molecular weight of the monomer. </span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>MM <span class="op">=</span> <span class="fl">86.09</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="co">##################################################################</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.2. Common reactions for all kinds of radical polymerizations #</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a required section.                                    #</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="co">##################################################################</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the rate coefficients for propagation and termination (by coupling or by disproportionation).</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>k_p <span class="op">=</span> <span class="dv">27254</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>k_tc <span class="op">=</span> <span class="fl">1e8</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>k_td <span class="op">=</span> <span class="fl">1e7</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the rate coefficients for the addition of the first monomer to the primary radical;</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="co"># the termination between primary radicals; the termination between a primary radical and a propagating radical. </span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>k_p_R <span class="op">=</span> k_p</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>k_t_R <span class="op">=</span> <span class="fl">2.5e9</span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>k_t_R_Pn <span class="op">=</span> <span class="fl">1e8</span> </span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the rate coefficient for chain transfer to monomer.</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>k_tr_M <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="co"># If syrenic type of monomers is used,</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a><span class="co"># set the rate coefficient of the thermal initiation of the monomer. </span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Leave this value as 0 when you do not want to consider thermal initiation. </span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="co"># For styrene, the value can be calculated as 2.2e5*exp(-13810/T), where T is the temperature in K. </span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>k_th_S <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="co">##############################################################</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.3. For conventional radical polymerization and ICAR ATRP #</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a><span class="co">##############################################################</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a><span class="co"># If a thermal initiator (TI), e.g., AIBN, BPO, is used in your reaction,</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a><span class="co"># set the initial concentration of the initiator.</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>c0_TI <span class="op">=</span> <span class="fl">0.00138</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the decomposition rate coefficient and the initiation efficiency for the initiator.</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>k_d_TI <span class="op">=</span> <span class="fl">9.7e-6</span></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>f_TI <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a><span class="co">##############################</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.4. For all kinds of ATRP #</span></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a><span class="co">##############################</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the initial concentration of RX. </span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>c0_RX <span class="op">=</span> <span class="fl">0.0275</span> </span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the initial concentration of Cu(I) and Cu(II).</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume there is a sufficient amount of ligand to coordinate with all Cu(I) and Cu(II),</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a><span class="co"># and the concentration of free ligand does not affect the reaction kinetics. </span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>c0_CuI <span class="op">=</span> <span class="fl">0.00275</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>c0_CuII <span class="op">=</span> <span class="fl">0.00275</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the rate coefficients for activation of RX; deactivation of radical R;  </span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>k_a_0_atrp <span class="op">=</span> <span class="fl">9.6</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>k_d_0_atrp <span class="op">=</span> <span class="fl">1e8</span></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the rate coefficient for activation of a polymer with a halogen chain end; </span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a><span class="co"># deactivation of a propagating radical. </span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>k_a_atrp <span class="op">=</span> <span class="fl">9.6</span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>k_d_atrp <span class="op">=</span> <span class="fl">1e8</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a><span class="co">##################################   </span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.4.1. For AGET and ARGET ATRP #</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a><span class="co">##################################</span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the initial concentration of the reducing agent. </span></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>c0_Reduc <span class="op">=</span> <span class="fl">2.5e-3</span> </span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the reduction rate coefficient</span></span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>k_reduc <span class="op">=</span> <span class="fl">1e-1</span> </span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a><span class="co">####################</span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.4.2. For eATRP #</span></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a><span class="co">####################</span></span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the rate coefficient of electronic reduction. </span></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a><span class="co"># This will mimic an eATRP process with constant voltage. </span></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a><span class="co"># CuII is converted to CuI at a rate of k_e_reduc*[CuII].</span></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>k_e_reduc <span class="op">=</span> <span class="fl">1e-7</span> </span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a><span class="co">###################</span></span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.4.3. For SARA #</span></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a><span class="co">###################</span></span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a><span class="co"># set the initial concentration of Cu(0) in cm^2/mL (surface area per unit volume). </span></span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume the Cu(0) wire or foil is thick enough that there is no apparent consumption during the polymerization.</span></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>c0_Cu0 <span class="op">=</span> <span class="dv">2</span> </span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the rate coefficients of Cu(0) activation and comproportionation.</span></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Deactivation by Cu(I) and disproportionation are neglected. </span></span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a>k_comp <span class="op">=</span> <span class="fl">1e-4</span> </span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a>k_a_Cu0 <span class="op">=</span> <span class="fl">1e-4</span> </span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a><span class="co">#######################################################</span></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.4.4. For ATRP by continuous feeding of Activators #</span></span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a><span class="co">#######################################################</span></span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the rate coefficient to minic different feeding rate. </span></span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a><span class="co"># CuI concentration will increase at a constant rate of k_cfa.</span></span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Volume change is neglected. </span></span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a>k_cfa <span class="op">=</span> <span class="fl">1.4e-8</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="construct-the-reaction-system" class="level2">
<h2 class="anchored" data-anchor-id="construct-the-reaction-system">3. Construct the reaction system</h2>
<div id="cell-8" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#@title { display-mode: "form" }</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Initiate the reaction system with null value. </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The rsys_orig is the system of the actual reactions.</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The rsys_pseudo includes the pseudo reactions with pseudo species </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># which are used to introduce 1st and 2nd order moments</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># and to adjust the reactions to take into account the initiation efficiency, etc. </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>rsys_orig <span class="op">=</span> ReactionSystem.from_string(<span class="st">"""</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>, substance_factory<span class="op">=</span>Substance)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>rsys_pseudo <span class="op">=</span>  ReactionSystem.from_string(<span class="st">"""</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>, substance_factory<span class="op">=</span>Substance)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial concentrations of monomer, dead chains, radicals, and pseudo species of moments.</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>c0 <span class="op">=</span> defaultdict(<span class="bu">float</span>, {<span class="st">'M'</span>: c0_M, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'PnD'</span>: <span class="dv">0</span>, <span class="st">'PnDPn'</span>: <span class="dv">0</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'Pn'</span>: <span class="dv">0</span>, <span class="st">'M1_Pn'</span>: <span class="dv">0</span>, <span class="op">\</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'M1_PnX'</span>: <span class="dv">0</span>, <span class="st">'M1_PnD'</span>: <span class="dv">0</span>, <span class="st">'M1_PnDPn'</span>: <span class="dv">0</span>, <span class="st">'M2_total'</span>: <span class="dv">0</span>}) </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add propagation and termination reactions to the reaction system. </span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>rsys_orig <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="ss">    R + M -&gt; Pn; </span><span class="sc">{</span>k_p_R<span class="sc">}</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="ss">    Pn + M -&gt; Pn; </span><span class="sc">{</span>k_p<span class="sc">}</span><span class="ss">      </span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="ss">    R + R -&gt; D + D; </span><span class="sc">{</span>k_t_R<span class="sc">}</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="ss">    Pn + R -&gt; PnD + D; </span><span class="sc">{</span>k_t_R_Pn<span class="sc">}</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="ss">    Pn + Pn -&gt; PnD + PnD; </span><span class="sc">{</span>k_td<span class="sc">}</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="ss">    Pn + Pn -&gt; PnDPn; </span><span class="sc">{</span>k_tc<span class="sc">}</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span>, substance_factory<span class="op">=</span>Substance)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>rsys_pseudo <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="ss">    R + M -&gt; R + M + M1_Pn + M2_total; </span><span class="sc">{</span>k_p_R<span class="sc">}</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="ss">    Pn + M -&gt; Pn + M + M1_Pn + M2_total; </span><span class="sc">{</span>k_p<span class="sc">}</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="ss">    M1_Pn + M -&gt; M1_Pn + M + M2_total; </span><span class="sc">{</span><span class="dv">2</span><span class="op">*</span>k_p<span class="sc">}</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="ss">    M1_Pn + R -&gt; M1_PnD + R; </span><span class="sc">{</span>k_t_R_Pn<span class="sc">}</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="ss">    M1_Pn + Pn -&gt; M1_PnD + Pn; </span><span class="sc">{</span><span class="dv">2</span><span class="op">*</span>k_td<span class="sc">}</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="ss">    M1_Pn + Pn -&gt; M1_PnDPn + Pn; </span><span class="sc">{</span><span class="dv">2</span><span class="op">*</span>k_tc<span class="sc">}</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="ss">    M1_Pn + M1_Pn -&gt; M1_Pn + M1_Pn + M2_total; </span><span class="sc">{</span><span class="dv">2</span><span class="op">*</span>k_tc<span class="sc">}</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span>, substance_factory<span class="op">=</span>Substance)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="co"># To include chain transfer to monomer</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> k_tr_M <span class="op">!=</span><span class="dv">0</span>:</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        rsys_orig <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="ss">        Pn + M -&gt; PnD + R; </span><span class="sc">{</span>k_tr_M<span class="sc">}</span><span class="ss">            </span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="ss">        """</span>, substance_factory<span class="op">=</span>Substance) </span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>        rsys_pseudo <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="ss">        M1_Pn + M -&gt; M1_PnD + M; </span><span class="sc">{</span>k_tr_M<span class="sc">}</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span>, substance_factory<span class="op">=</span>Substance)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co"># To include the thermal initiaion for styrenic monomers</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> k_th_S <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>    rsys_orig <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="ss">        M + M + M -&gt; R + R; </span><span class="sc">{</span>k_th_S<span class="sc">}</span><span class="ss">            </span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="ss">        """</span>, substance_factory<span class="op">=</span>Substance) </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co"># For all kinds of ATRP </span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> Poly_type <span class="op">!=</span> <span class="st">'conven'</span>:</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>    c0.update({<span class="st">'RX'</span>: c0_RX, <span class="st">'PnX'</span>:<span class="dv">0</span>, <span class="st">'CuI'</span>: c0_CuI, <span class="st">'CuII'</span>: c0_CuII})</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>    rsys_orig <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="ss">        CuI + RX -&gt; CuII + R; </span><span class="sc">{</span>k_a_0_atrp<span class="sc">}</span><span class="ss">     </span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="ss">        CuII + R -&gt; CuI + RX; </span><span class="sc">{</span>k_d_0_atrp<span class="sc">}</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="ss">        CuI + PnX -&gt; CuII + Pn; </span><span class="sc">{</span>k_a_atrp<span class="sc">}</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a><span class="ss">        CuII + Pn -&gt; CuI + PnX; </span><span class="sc">{</span>k_d_atrp<span class="sc">}</span><span class="ss">        </span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="ss">        """</span>, substance_factory<span class="op">=</span>Substance)  </span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>    rsys_pseudo <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a><span class="ss">        M1_PnX + CuI -&gt; M1_Pn + CuI; </span><span class="sc">{</span>k_a_atrp<span class="sc">}</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a><span class="ss">        M1_Pn + CuII -&gt; M1_PnX + CuII; </span><span class="sc">{</span>k_d_atrp<span class="sc">}</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a><span class="ss">        """</span>, substance_factory<span class="op">=</span>Substance) </span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a><span class="co"># For AGET and ARGET ATRP</span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> Poly_type <span class="op">==</span> <span class="st">'arget'</span>:</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>    c0.update({<span class="st">'Reduc'</span>: c0_Reduc, <span class="st">'ReducX'</span>:<span class="dv">0</span>})</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>    rsys_orig <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="ss">        Reduc + CuII -&gt; ReducX + CuI; </span><span class="sc">{</span>k_reduc<span class="sc">}</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a><span class="ss">        """</span>, substance_factory<span class="op">=</span>Substance)    </span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a><span class="co"># For eATRP </span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> Poly_type <span class="op">==</span> <span class="st">'eatrp'</span>:</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>    c0.update({<span class="st">'elec'</span>: <span class="dv">1</span>})    </span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>    rsys_orig <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a><span class="ss">        elec + CuII -&gt; CuI + elec; </span><span class="sc">{</span>k_e_reduc<span class="sc">}</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a><span class="ss">        """</span>, substance_factory<span class="op">=</span>Substance)   </span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a><span class="co"># For SARA ATRP</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> Poly_type <span class="op">==</span> <span class="st">'sara'</span>:</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>    c0.update({<span class="st">'Cu0'</span>: c0_Cu0})    </span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>    rsys_orig <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a><span class="ss">        Cu0 + CuII -&gt; CuI + CuI + Cu0; </span><span class="sc">{</span>k_comp<span class="sc">}</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a><span class="ss">        Cu0 + RX -&gt; CuI + R + Cu0; </span><span class="sc">{</span>k_a_Cu0<span class="sc">}</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a><span class="ss">        """</span>, substance_factory<span class="op">=</span>Substance)</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a><span class="co"># For ATRP by continuous feeding of activators</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> Poly_type <span class="op">==</span> <span class="st">'cfa'</span>:</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>    c0.update({<span class="st">'CuIsour'</span>: <span class="dv">1</span>})    </span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>    rsys_orig <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a><span class="ss">        CuIsour -&gt; CuI + CuIsour; </span><span class="sc">{</span>k_cfa<span class="sc">}</span></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a><span class="ss">        """</span>, substance_factory<span class="op">=</span>Substance)  </span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a><span class="co"># For conventional radical polymerization and ICAR ATRP </span></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a><span class="co"># The thermal initiator is consumed with a rate coefficient k_d_TI;</span></span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a><span class="co"># however, not all of the primary radicals would involve in propagation.</span></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a><span class="co"># To take into account the initiation efficiency, pseudo reactions and a pseudo species 'PR' are introduced. </span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> Poly_type <span class="op">==</span> <span class="st">'conven'</span> <span class="kw">or</span> Poly_type <span class="op">==</span> <span class="st">'icar'</span>:</span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>    c0.update({<span class="st">'TI'</span>: c0_TI, <span class="st">'PR'</span>: <span class="dv">0</span>})   </span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>    rsys_orig <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a><span class="ss">        TI -&gt; R + R; </span><span class="sc">{</span>k_d_TI<span class="sc">}</span></span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a><span class="ss">        """</span>, substance_factory<span class="op">=</span>Substance)</span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>    rsys_pseudo <span class="op">+=</span> ReactionSystem.from_string(<span class="ss">f"""</span></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a><span class="ss">        TI -&gt; R + R; </span><span class="sc">{</span><span class="op">-</span>k_d_TI<span class="sc">}</span></span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a><span class="ss">        TI -&gt; PR + PR; </span><span class="sc">{</span>k_d_TI<span class="sc">}</span><span class="ss">    </span></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a><span class="ss">        TI -&gt; TI + R + R; </span><span class="sc">{</span>f_TI<span class="op">*</span>k_d_TI<span class="sc">}</span></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a><span class="ss">        """</span>, substance_factory<span class="op">=</span>Substance)  </span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The initial concentrations of the reagents are:"</span>)</span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key <span class="kw">in</span> c0:</span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> c0[key] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(key, <span class="st">': '</span>, c0[key])</span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The reactions and the rate coefficients are:"</span>)</span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>rsys_orig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The initial concentrations of the reagents are:
M :  5.5
RX :  0.0275
CuI :  0.00275
CuII :  0.00275
The reactions and the rate coefficients are:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="6">
<table class="chempy_ReactionSystem chempy_2900239918536 caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td colspan="5" style="text-align: center;" data-quarto-table-cell-role="th"></td>
</tr>
<tr class="chempy_2900239918536_0 even">
<td style="text-align: right;"><span class="chempy_M" style="background-color:#ffb6c1; border: 1px solid #c71585; border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">M</span> + <span class="chempy_R" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">R</span></td>
<td style="text-align: center;">→</td>
<td style="text-align: left;"><span class="chempy_Pn" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">Pn</span></td>
<td style="text-align: left;">&nbsp;27254</td>
<td style="text-align: center;"></td>
</tr>
<tr class="chempy_2900239918536_1 odd">
<td style="text-align: right;"><span class="chempy_M" style="background-color:#ffb6c1; border: 1px solid #c71585; border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">M</span> + <span class="chempy_Pn" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">Pn</span></td>
<td style="text-align: center;">→</td>
<td style="text-align: left;"><span class="chempy_Pn" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">Pn</span></td>
<td style="text-align: left;">&nbsp;27254</td>
<td style="text-align: center;"></td>
</tr>
<tr class="chempy_2900239918536_2 even">
<td style="text-align: right;">2 <span class="chempy_R" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">R</span></td>
<td style="text-align: center;">→</td>
<td style="text-align: left;">2 <span class="chempy_D" style="background-color:#90ee90; border: 1px solid #008000; border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">D</span></td>
<td style="text-align: left;">&nbsp;2.5⋅10<sup>9</sup></td>
<td style="text-align: center;"></td>
</tr>
<tr class="chempy_2900239918536_3 odd">
<td style="text-align: right;"><span class="chempy_Pn" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">Pn</span> + <span class="chempy_R" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">R</span></td>
<td style="text-align: center;">→</td>
<td style="text-align: left;"><span class="chempy_D" style="background-color:#90ee90; border: 1px solid #008000; border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">D</span> + <span class="chempy_PnD" style="background-color:#90ee90; border: 1px solid #008000; border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">PnD</span></td>
<td style="text-align: left;">&nbsp;10<sup>8</sup></td>
<td style="text-align: center;"></td>
</tr>
<tr class="chempy_2900239918536_4 even">
<td style="text-align: right;">2 <span class="chempy_Pn" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">Pn</span></td>
<td style="text-align: center;">→</td>
<td style="text-align: left;">2 <span class="chempy_PnD" style="background-color:#90ee90; border: 1px solid #008000; border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">PnD</span></td>
<td style="text-align: left;">&nbsp;10<sup>7</sup></td>
<td style="text-align: center;"></td>
</tr>
<tr class="chempy_2900239918536_5 odd">
<td style="text-align: right;">2 <span class="chempy_Pn" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">Pn</span></td>
<td style="text-align: center;">→</td>
<td style="text-align: left;"><span class="chempy_PnDPn" style="background-color:#90ee90; border: 1px solid #008000; border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">PnDPn</span></td>
<td style="text-align: left;">&nbsp;10<sup>8</sup></td>
<td style="text-align: center;"></td>
</tr>
<tr class="chempy_2900239918536_6 even">
<td style="text-align: right;"><span class="chempy_CuI" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">CuI</span> + <span class="chempy_RX" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">RX</span></td>
<td style="text-align: center;">→</td>
<td style="text-align: left;"><span class="chempy_CuII" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">CuII</span> + <span class="chempy_R" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">R</span></td>
<td style="text-align: left;">&nbsp;9.6</td>
<td style="text-align: center;"></td>
</tr>
<tr class="chempy_2900239918536_7 odd">
<td style="text-align: right;"><span class="chempy_CuII" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">CuII</span> + <span class="chempy_R" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">R</span></td>
<td style="text-align: center;">→</td>
<td style="text-align: left;"><span class="chempy_CuI" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">CuI</span> + <span class="chempy_RX" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">RX</span></td>
<td style="text-align: left;">&nbsp;10<sup>8</sup></td>
<td style="text-align: center;"></td>
</tr>
<tr class="chempy_2900239918536_8 even">
<td style="text-align: right;"><span class="chempy_CuI" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">CuI</span> + <span class="chempy_PnX" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">PnX</span></td>
<td style="text-align: center;">→</td>
<td style="text-align: left;"><span class="chempy_CuII" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">CuII</span> + <span class="chempy_Pn" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">Pn</span></td>
<td style="text-align: left;">&nbsp;9.6</td>
<td style="text-align: center;"></td>
</tr>
<tr class="chempy_2900239918536_9 odd">
<td style="text-align: right;"><span class="chempy_CuII" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">CuII</span> + <span class="chempy_Pn" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">Pn</span></td>
<td style="text-align: center;">→</td>
<td style="text-align: left;"><span class="chempy_CuI" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">CuI</span> + <span class="chempy_PnX" style="border-radius: 5pt; padding: 0pt 3pt 0pt 3pt;">PnX</span></td>
<td style="text-align: left;">&nbsp;10<sup>8</sup></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<script type="text/javascript">
var cls_names_substances = ["chempy_D", "chempy_M", "chempy_Pn", "chempy_PnD", "chempy_PnDPn", "chempy_R", "chempy_CuI", "chempy_CuII", "chempy_PnX", "chempy_RX"];
var substance_row_cls_irrel = {"chempy_D": ["chempy_2900239918536_0", "chempy_2900239918536_1", "chempy_2900239918536_4", "chempy_2900239918536_5", "chempy_2900239918536_6", "chempy_2900239918536_7", "chempy_2900239918536_8", "chempy_2900239918536_9"], "chempy_M": ["chempy_2900239918536_2", "chempy_2900239918536_3", "chempy_2900239918536_4", "chempy_2900239918536_5", "chempy_2900239918536_6", "chempy_2900239918536_7", "chempy_2900239918536_8", "chempy_2900239918536_9"], "chempy_Pn": ["chempy_2900239918536_2", "chempy_2900239918536_6", "chempy_2900239918536_7"], "chempy_PnD": ["chempy_2900239918536_0", "chempy_2900239918536_1", "chempy_2900239918536_2", "chempy_2900239918536_5", "chempy_2900239918536_6", "chempy_2900239918536_7", "chempy_2900239918536_8", "chempy_2900239918536_9"], "chempy_PnDPn": ["chempy_2900239918536_0", "chempy_2900239918536_1", "chempy_2900239918536_2", "chempy_2900239918536_3", "chempy_2900239918536_4", "chempy_2900239918536_6", "chempy_2900239918536_7", "chempy_2900239918536_8", "chempy_2900239918536_9"], "chempy_R": ["chempy_2900239918536_1", "chempy_2900239918536_4", "chempy_2900239918536_5", "chempy_2900239918536_8", "chempy_2900239918536_9"], "chempy_CuI": ["chempy_2900239918536_0", "chempy_2900239918536_1", "chempy_2900239918536_2", "chempy_2900239918536_3", "chempy_2900239918536_4", "chempy_2900239918536_5"], "chempy_CuII": ["chempy_2900239918536_0", "chempy_2900239918536_1", "chempy_2900239918536_2", "chempy_2900239918536_3", "chempy_2900239918536_4", "chempy_2900239918536_5"], "chempy_PnX": ["chempy_2900239918536_0", "chempy_2900239918536_1", "chempy_2900239918536_2", "chempy_2900239918536_3", "chempy_2900239918536_4", "chempy_2900239918536_5", "chempy_2900239918536_6", "chempy_2900239918536_7"], "chempy_RX": ["chempy_2900239918536_0", "chempy_2900239918536_1", "chempy_2900239918536_2", "chempy_2900239918536_3", "chempy_2900239918536_4", "chempy_2900239918536_5", "chempy_2900239918536_8", "chempy_2900239918536_9"]};
var elms = {};
var n = {}, nsubstances = cls_names_substances.length;
var nirrel = {};
function changeColor(classname, color) {
    var curN = n[classname];
    for(var i = 0; i < curN; i++) {
        elms[classname][i].style.backgroundColor = color;
    }
}
function toggleVisibility(classname_substance) {
    var curN = nirrel[classname_substance];
    for (var i=0; i<curN; i++) {
        var objs = document.getElementsByClassName(substance_row_cls_irrel[classname_substance][i]);
        for (var j=0; j<objs.length; ++j){
            objs[j].style.display = objs[j].style.display == "none" ? "table-row" : "none";
        }
    }
}
function resetTab(tab){
    tab.style.border = "0px";
    var rows = tab.getElementsByTagName('tr');
    [].forEach.call(rows, function(row){
        row.style.display = "table-row";
    });
    tab.getElementsByTagName('th')[0].innerHTML = tab.ori_header +
        "<br>(click on species to show a subset of reactions)";
};

for(var k = 0; k < nsubstances; k++) {
    var curClass = cls_names_substances[k];
    var curIrrel = substance_row_cls_irrel[k];
    elms[curClass] = document.getElementsByClassName(curClass);
    n[curClass] = elms[curClass].length;
    nirrel[curClass] = substance_row_cls_irrel[curClass].length;
    var curN = n[curClass];
    for(var i = 0; i < curN; i++) {
        elms[curClass][i].onmouseover = function() {
            changeColor(this.className, "LightBlue");
        };
        elms[curClass][i].onmouseout = function() {
            changeColor(this.className, "inherit");
        };
        elms[curClass][i].onclick = function() {
            var tab = this.closest("table");
            resetTab(tab);
            tab.style.border = "1px dashed #000000";
            toggleVisibility(this.className);
            tab.getElementsByTagName('th')[0].innerHTML = tab.ori_header +
                 "<br>Only showing reactions involving: " + this.innerHTML +
                 " (double-click to reset)";
        };
    }
};
var chempy_tabs = document.querySelectorAll('table.chempy_2900239918536');
[].forEach.call(chempy_tabs, function(tab){
    tab.ori_header = tab.getElementsByTagName('th')[0].innerHTML;
    tab.ondblclick = function(){
        resetTab(this);
        this.scrollIntoView();
    };
});
[].forEach.call(chempy_tabs, function(tab){
    resetTab(tab);
});
</script>
</div>
</div>
</section>
<section id="simulation" class="level2">
<h2 class="anchored" data-anchor-id="simulation">4. Simulation</h2>
<p><strong>List of the differential equations</strong></p>
<div id="cell-10" class="cell" data-scrolled="true" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#@title { display-mode: "form" }</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the actual and the pseudo reaction systems</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>rsys <span class="op">=</span> rsys_orig <span class="op">+</span> rsys_pseudo</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the differential equation system from the reactions.</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>odesys, extra <span class="op">=</span> get_odesys(rsys)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># List the differential equations</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The differnetial equations are:"</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, exp <span class="kw">in</span> <span class="bu">enumerate</span>(odesys.exprs):</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> odesys.names[index] <span class="op">!=</span> <span class="st">'PR'</span>:</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(odesys.names[index], <span class="st">': '</span>, <span class="ss">f'dy_</span><span class="sc">{</span>index<span class="sc">}</span><span class="ss">/dt'</span>, <span class="st">'= '</span>,  exp)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Integration</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>tout <span class="op">=</span> <span class="bu">sorted</span>(np.concatenate((np.linspace(<span class="dv">0</span>, react_time), np.logspace(<span class="dv">0</span>, np.floor(np.log10(react_time))))))</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> odesys.integrate(tout, c0, integrator<span class="op">=</span><span class="st">'scipy'</span>, method<span class="op">=</span><span class="st">'lsoda'</span>, atol<span class="op">=</span><span class="fl">1e-12</span>, rtol<span class="op">=</span><span class="fl">1e-6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The differnetioal equations are:
D :  dy_0/dt =  100000000.0*y_2*y_5 + 5000000000.0*y_5**2
M :  dy_1/dt =  -27254*y_1*y_2 - 27254*y_1*y_5
Pn :  dy_2/dt =  27254*y_1*y_5 - 220000000.0*y_2**2 - 100000000.0*y_2*y_5 - 100000000.0*y_2*y_7 + 9.6*y_6*y_8
PnD :  dy_3/dt =  20000000.0*y_2**2 + 100000000.0*y_2*y_5
PnDPn :  dy_4/dt =  100000000.0*y_2**2
R :  dy_5/dt =  -27254*y_1*y_5 - 100000000.0*y_2*y_5 - 5000000000.0*y_5**2 - 100000000.0*y_5*y_7 + 9.6*y_6*y_9
CuI :  dy_6/dt =  100000000.0*y_2*y_7 + 100000000.0*y_5*y_7 - 9.6*y_6*y_8 - 9.6*y_6*y_9
CuII :  dy_7/dt =  -100000000.0*y_2*y_7 - 100000000.0*y_5*y_7 + 9.6*y_6*y_8 + 9.6*y_6*y_9
PnX :  dy_8/dt =  100000000.0*y_2*y_7 - 9.6*y_6*y_8
RX :  dy_9/dt =  100000000.0*y_5*y_7 - 9.6*y_6*y_9
M1_Pn :  dy_10/dt =  27254*y_1*y_2 + 27254*y_1*y_5 - 220000000.0*y_10*y_2 - 100000000.0*y_10*y_5 - 100000000.0*y_10*y_7 + 9.6*y_14*y_6
M1_PnD :  dy_11/dt =  20000000.0*y_10*y_2 + 100000000.0*y_10*y_5
M1_PnDPn :  dy_12/dt =  200000000.0*y_10*y_2
M2_total :  dy_13/dt =  54508*y_1*y_10 + 27254*y_1*y_2 + 27254*y_1*y_5 + 200000000.0*y_10**2
M1_PnX :  dy_14/dt =  100000000.0*y_10*y_7 - 9.6*y_14*y_6</code></pre>
</div>
</div>
<p>The differential equation system includes not only the real species, i.e., those taht appear in the actual reactions, but also the pseudo species, e.g., the 1st and 2nd order moments.</p>
<section id="about-the-integrator-and-the-integration-method" class="level4">
<h4 class="anchored" data-anchor-id="about-the-integrator-and-the-integration-method">About the integrator and the integration method</h4>
<p>If you are not familiar with the ode integrators and the numerical methods, just leave the default setting without any change.</p>
<p>For advanced users, the following information could be helpful.</p>
<p>By default, the program uses scipy.integrate.ode as the ODE integrator with “lsoda” as the selected method. The “lsoda” method automatically switches for stiff and non-stiff ODEs. This subroutine uses the Adams method for non-stiff ODEs and a backward differentiation formula (BDF) method for stiff ODEs. Other available methods can be found on the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.ode.html#scipy.integrate.ode">official website of scipy</a>. For more options, please visit the <a href="https://pypi.org/project/pyodesys/0.1.2/">website of pyodesys</a>. You can install packages and use integrators other than scipy.</p>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">5. Results</h2>
<section id="concentration-changes" class="level3">
<h3 class="anchored" data-anchor-id="concentration-changes">5.1. Concentration changes</h3>
<p>Plot the concentrations of species in the reaction system vs time. The change of monomer concentration is not included here since monomer conversion will be plotted later.</p>
<div id="cell-15" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#@title { display-mode: "form" }</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>[<span class="st">'(a)'</span>,<span class="st">'(b)'</span>,<span class="st">'(c)'</span>]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>i<span class="op">=</span><span class="dv">0</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>fig1, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes:</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>     _ <span class="op">=</span> result.plot(names<span class="op">=</span>[k <span class="cf">for</span> k <span class="kw">in</span> rsys_orig.substances <span class="cf">if</span> k <span class="op">!=</span> <span class="st">'CuIsour'</span> \</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                            <span class="kw">and</span> k <span class="op">!=</span> <span class="st">'M'</span> <span class="kw">and</span> k<span class="op">!=</span> <span class="st">'elec'</span> <span class="kw">and</span> k <span class="op">!=</span> <span class="st">'Cu0'</span>], ax<span class="op">=</span>ax) </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>     _ <span class="op">=</span> ax.legend(loc<span class="op">=</span><span class="st">'best'</span>,prop<span class="op">=</span>{<span class="st">'size'</span>: <span class="dv">12</span>}) <span class="co"># Set the font size of the legend here.    </span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>     _ <span class="op">=</span> ax.set_xlabel(<span class="st">'Time (s)'</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>     _ <span class="op">=</span> ax.set_ylabel(<span class="st">'Concentration'</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>     _ <span class="op">=</span> ax.text(<span class="op">-</span><span class="fl">0.1</span>, <span class="dv">1</span>, labels[i], transform<span class="op">=</span>ax.transAxes, fontweight<span class="op">=</span><span class="st">'bold'</span>, va<span class="op">=</span><span class="st">'top'</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>     i<span class="op">+=</span><span class="dv">1</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].ticklabel_format(axis<span class="op">=</span><span class="st">"x"</span>, style<span class="op">=</span><span class="st">"sci"</span>, scilimits<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> axes[<span class="dv">1</span>].set_ylim([<span class="fl">1e-10</span>, <span class="fl">1e1</span>])</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> axes[<span class="dv">1</span>].set_xscale(<span class="st">'log'</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> axes[<span class="dv">1</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> fig1.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ATRP_Kinetic_Simulator_Moments_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="meanings-of-the-species-produced-during-the-polymerization" class="level4">
<h4 class="anchored" data-anchor-id="meanings-of-the-species-produced-during-the-polymerization">Meanings of the species produced during the polymerization</h4>
<p>R: primary radical either from RX or from the thermal initiator<br>
D: termination product from primary radicals<br>
Pn: propagating polymer chain with a chain end radical<br>
PnD: dead polymer chain produced by termination through disproportionation<br>
PnDPn: dead polymer chain produced by termination through coupling<br>
PnX: dormant polymer chain with an active halogen chain-end</p>
</section>
</section>
<section id="monomer-conversion-vs-time" class="level3">
<h3 class="anchored" data-anchor-id="monomer-conversion-vs-time">5.2. Monomer conversion vs time</h3>
<div id="cell-18" class="cell" data-scrolled="true" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#@title { display-mode: "form" }</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get concentrations and calculate conversion, Mn and Mw/Mn.</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>ConcM <span class="op">=</span> result[<span class="dv">1</span>][:,result.odesys.names.index(<span class="st">'M'</span>)]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>ConcD <span class="op">=</span> result[<span class="dv">1</span>][:,result.odesys.names.index(<span class="st">'D'</span>)]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>ConcPnD <span class="op">=</span> result[<span class="dv">1</span>][:,result.odesys.names.index(<span class="st">'PnD'</span>)]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>ConcPnDPn <span class="op">=</span> result[<span class="dv">1</span>][:,result.odesys.names.index(<span class="st">'PnDPn'</span>)]</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>ConcPn <span class="op">=</span> result[<span class="dv">1</span>][:,result.odesys.names.index(<span class="st">'Pn'</span>)]</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>ConcM2_total <span class="op">=</span> result[<span class="dv">1</span>][:,result.odesys.names.index(<span class="st">'M2_total'</span>)]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> Poly_type <span class="op">!=</span> <span class="st">'conven'</span>:</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    ConcPnX <span class="op">=</span> result[<span class="dv">1</span>][:,result.odesys.names.index(<span class="st">'PnX'</span>)]</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    ConcPnX <span class="op">=</span> np.zeros(<span class="bu">len</span>(result[<span class="dv">0</span>]))</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>ConvM <span class="op">=</span>(ConcM[<span class="dv">0</span>]<span class="op">-</span>ConcM)<span class="op">/</span>ConcM[<span class="dv">0</span>]</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>LnM0_M <span class="op">=</span> np.log(ConcM[<span class="dv">0</span>]<span class="op">/</span>ConcM)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>Mn <span class="op">=</span> np.zeros(<span class="bu">len</span>(result[<span class="dv">0</span>]))</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>Mw <span class="op">=</span> np.zeros(<span class="bu">len</span>(result[<span class="dv">0</span>]))</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>Mw_Mn <span class="op">=</span> np.ones(<span class="bu">len</span>(result[<span class="dv">0</span>]))</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>Mn[<span class="dv">1</span>:] <span class="op">=</span> (ConcM[<span class="dv">0</span>]<span class="op">-</span>ConcM[<span class="dv">1</span>:])<span class="op">/</span>(ConcPnX[<span class="dv">1</span>:] <span class="op">+</span> ConcPnD[<span class="dv">1</span>:] <span class="op">+</span> ConcPnDPn[<span class="dv">1</span>:] <span class="op">+</span> ConcPn[<span class="dv">1</span>:])<span class="op">*</span>MM</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>Mw[<span class="dv">1</span>:] <span class="op">=</span> ConcM2_total[<span class="dv">1</span>:]<span class="op">/</span>(ConcM[<span class="dv">0</span>]<span class="op">-</span>ConcM[<span class="dv">1</span>:])<span class="op">*</span>MM    </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>Mw_Mn[<span class="dv">1</span>:] <span class="op">=</span> Mw[<span class="dv">1</span>:]<span class="op">/</span>Mn[<span class="dv">1</span>:]</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Get mole percent of end group loss, i.e., Tmol%.</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> Poly_type <span class="op">!=</span> <span class="st">'conven'</span>:</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>result.odesys.names.index(<span class="st">'RX'</span>)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    Tmol <span class="op">=</span> <span class="dv">100</span><span class="op">*</span>(ConcD <span class="op">+</span> ConcPnD <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>ConcPnDPn)<span class="op">/</span>result[<span class="dv">1</span>][<span class="dv">0</span>,x]</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    Tmol <span class="op">=</span> <span class="dv">100</span><span class="op">*</span>np.ones(<span class="bu">len</span>(result[<span class="dv">0</span>]))</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>result_cal <span class="op">=</span> [result[<span class="dv">0</span>],ConcM,ConvM,LnM0_M,Mn,Mw_Mn,Tmol]</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Monomer conversion vs. time and first order kinetic plots. </span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>fig2, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>i<span class="op">=</span><span class="dv">0</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes:</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    ax.ticklabel_format(axis<span class="op">=</span><span class="st">"x"</span>, style<span class="op">=</span><span class="st">"sci"</span>, scilimits<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> ax.plot(result_cal[<span class="dv">0</span>], result_cal[i<span class="op">+</span><span class="dv">2</span>])</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> ax.text(<span class="op">-</span><span class="fl">0.1</span>, <span class="dv">1</span>, labels[i], transform<span class="op">=</span>ax.transAxes, fontweight<span class="op">=</span><span class="st">'bold'</span>, va<span class="op">=</span><span class="st">'top'</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> ax.grid()</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> axes[<span class="dv">0</span>].<span class="bu">set</span>(xlabel <span class="op">=</span> <span class="st">'Time (s)'</span>, ylabel<span class="op">=</span><span class="st">'Conversion'</span>)</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> axes[<span class="dv">1</span>].<span class="bu">set</span>(xlabel <span class="op">=</span> <span class="st">'Time (s)'</span>, ylabel<span class="op">=</span><span class="st">'Ln([M]0/[M])'</span>)</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> fig2.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ATRP_Kinetic_Simulator_Moments_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="molecular-weight-molecular-weight-distribution-and-mole-percent-loss-of-chain-ends." class="level3">
<h3 class="anchored" data-anchor-id="molecular-weight-molecular-weight-distribution-and-mole-percent-loss-of-chain-ends.">5.3. Molecular weight, molecular weight distribution and mole percent loss of chain-ends.</h3>
<div id="cell-20" class="cell" data-scrolled="true" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#@title { display-mode: "form" }</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Mn, Mw/Mn and Tmol% vs. conversion. </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>fig3, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>i<span class="op">=</span><span class="dv">0</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes:</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> ax.plot(result_cal[<span class="dv">2</span>][<span class="dv">1</span>:], result_cal[i<span class="op">+</span><span class="dv">4</span>][<span class="dv">1</span>:])</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> ax.text(<span class="op">-</span><span class="fl">0.1</span>, <span class="dv">1</span>, labels[i], transform<span class="op">=</span>ax.transAxes, fontweight<span class="op">=</span><span class="st">'bold'</span>, va<span class="op">=</span><span class="st">'top'</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> ax.grid()</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> axes[<span class="dv">0</span>].<span class="bu">set</span>(xlabel <span class="op">=</span> <span class="st">'Conversion'</span>, ylabel<span class="op">=</span><span class="st">'Mn'</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].ticklabel_format(axis<span class="op">=</span><span class="st">"y"</span>, style<span class="op">=</span><span class="st">"sci"</span>, scilimits<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> axes[<span class="dv">1</span>].<span class="bu">set</span>(xlabel <span class="op">=</span> <span class="st">'Conversion'</span>, ylabel<span class="op">=</span><span class="st">'Mw/Mn'</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> axes[<span class="dv">2</span>].<span class="bu">set</span>(xlabel <span class="op">=</span> <span class="st">'Conversion'</span>, ylabel<span class="op">=</span><span class="st">'Tmol% (%)'</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> fig3.tight_layout()</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> Poly_type <span class="op">==</span> <span class="st">'conven'</span>:</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Tmol</span><span class="sc">% d</span><span class="st">oes not apply to conventional radical polymerization.'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ATRP_Kinetic_Simulator_Moments_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Note: the meaning of mole percent loss of the chain end, i.e., <span class="math inline">\(T_\text{mol%}\)</span>, can be found in the following article.[3] This calculated <span class="math inline">\(T_\text{mol%}\)</span> values could be significantly different from the experimental values because in the simulation only direct termination between two radicals is taken into account for the loss of chain-end functionalities, while other possible reactions causing the loss of chain ends, e.g., Cu(I) induced catalytic radical termination,[4] are not included.</p>
<p>[3]: Yu Wang, Mingjiang Zhong, Yaozhong Zhang, Andrew J. D. Magenau, and Krzysztof Matyjaszewski, Halogen Conservation in Atom Transfer Radical Polymerization, <em>Macromolecules</em> <strong>2012</strong>, <em>45</em>, 8929-8932, <a href="https://doi.org/10.1021/ma3018958">DOI: 10.1021/ma3018958</a><br>
[4]: Yu Wang, Nicolai Soerensen, Mingjiang Zhong, Hendrik Schroeder, Michael Buback, and Krzysztof Matyjaszewski, Improving the “Livingness” of ATRP by Reducing Cu Catalyst Concentration, <em>Macromolecules</em> <strong>2013</strong>, <em>46</em>, 683-691, <a href="https://doi.org/10.1021/ma3024393">DOI: 10.1021/ma3024393</a>.</p>
</section>
</section>
<section id="export-the-results" class="level2">
<h2 class="anchored" data-anchor-id="export-the-results">6. Export the results</h2>
<p>Export the result to a CSV file. If you run this program on your own computer, the CSV file is saved in the same folder as this ipynb file. If you run this program online using Google Colab, you can find the a menu bar on the left side. Click on the fourth one called “Files” and you will see the exported files.</p>
<div id="cell-23" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#@title { display-mode: "form" } </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>now <span class="op">=</span> datetime.datetime.now()</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>filename <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>now<span class="sc">.</span>strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">-%Hh%Mm%Ss"</span>)<span class="sc">}</span><span class="ss">-ATRP-Simulation-</span><span class="sc">{</span>Poly_type<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>Monomer<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>Solvent<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>Ligand<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>Initiator<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>Temperature<span class="sc">}</span><span class="ss">C.csv'</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">'w'</span>, newline<span class="op">=</span><span class="st">''</span>) <span class="im">as</span> f:</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    thewriter <span class="op">=</span> csv.writer(f)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> rxn <span class="kw">in</span> rsys_orig.rxns:</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        thewriter.writerow([rxn])</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> Poly_type <span class="op">==</span> <span class="st">'conven'</span> <span class="kw">or</span> Poly_type <span class="op">==</span> <span class="st">'icar'</span>:</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        thewriter.writerow([<span class="ss">f'The initiation efficiency of the thermal initiator is </span><span class="sc">{</span>f_TI<span class="sc">}</span><span class="ss">.'</span>])</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index, exp <span class="kw">in</span> <span class="bu">enumerate</span>(odesys.exprs):</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> odesys.names[index] <span class="op">!=</span> <span class="st">'PR'</span>:</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>            thewriter.writerow([<span class="ss">f'</span><span class="sc">{</span>odesys<span class="sc">.</span>names[index]<span class="sc">}</span><span class="ss">:'</span>,<span class="ss">f'dy_</span><span class="sc">{</span>index<span class="sc">}</span><span class="ss">/dt = </span><span class="sc">{</span>exp<span class="sc">}</span><span class="ss">'</span>])    </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> Poly_type <span class="op">==</span> <span class="st">'conven'</span>:</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        thewriter.writerow([<span class="st">'Tmol</span><span class="sc">% d</span><span class="st">oes not apply to conventional radical polymerization.'</span>])</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    thewriter.writerow([<span class="st">'time (s)'</span>]<span class="op">+</span>[k <span class="cf">for</span> k <span class="kw">in</span> rsys.substances <span class="cf">if</span> k <span class="op">!=</span> <span class="st">'PR'</span>]<span class="op">+</span>[<span class="st">'conversion'</span>]<span class="op">+</span>[<span class="st">'ln([M]0/[M])'</span>]<span class="op">\</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                       <span class="op">+</span>[<span class="st">'Mn'</span>]<span class="op">+</span>[<span class="st">'Mw/Mn'</span>]<span class="op">+</span>[<span class="st">'Tmol% (%)'</span>])</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    i<span class="op">=</span><span class="dv">0</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> concen <span class="kw">in</span> result[<span class="dv">1</span>]:</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>        thewriter.writerow([result_cal[<span class="dv">0</span>][i]]<span class="op">+</span>[concen[result.odesys.names.index(k)] <span class="cf">for</span> k <span class="kw">in</span> rsys.substances <span class="op">\</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>                                               <span class="cf">if</span> k <span class="op">!=</span> <span class="st">'PR'</span>] <span class="op">+</span>[ConvM[i]]<span class="op">+</span>[LnM0_M[i]]<span class="op">+</span>[Mn[i]]<span class="op">+</span>[Mw_Mn[i]]<span class="op">+</span>[Tmol[i]])</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        i<span class="op">+=</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Export the plots as pdf and png files.</p>
<div id="cell-25" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#@title { display-mode: "form" }</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>fig1.savefig(<span class="ss">f'</span><span class="sc">{</span>now<span class="sc">.</span>strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">-%Hh%Mm%Ss"</span>)<span class="sc">}</span><span class="ss">-concentration.pdf'</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>fig1.savefig(<span class="ss">f'</span><span class="sc">{</span>now<span class="sc">.</span>strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">-%Hh%Mm%Ss"</span>)<span class="sc">}</span><span class="ss">-concentration.png'</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, dpi<span class="op">=</span><span class="dv">600</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>fig2.savefig(<span class="ss">f'</span><span class="sc">{</span>now<span class="sc">.</span>strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">-%Hh%Mm%Ss"</span>)<span class="sc">}</span><span class="ss">-conversion.pdf'</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>fig2.savefig(<span class="ss">f'</span><span class="sc">{</span>now<span class="sc">.</span>strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">-%Hh%Mm%Ss"</span>)<span class="sc">}</span><span class="ss">-conversion.png'</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, dpi<span class="op">=</span><span class="dv">600</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>fig3.savefig(<span class="ss">f'</span><span class="sc">{</span>now<span class="sc">.</span>strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">-%Hh%Mm%Ss"</span>)<span class="sc">}</span><span class="ss">-molecular_weight.pdf'</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>fig3.savefig(<span class="ss">f'</span><span class="sc">{</span>now<span class="sc">.</span>strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">-%Hh%Mm%Ss"</span>)<span class="sc">}</span><span class="ss">-molecular_weight.png'</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, dpi<span class="op">=</span><span class="dv">600</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<center>
<img src="https://raw.githubusercontent.com/wangyu16/PolymerScienceEducation/65e7e0eb7d7fb9af687c84be7015b4f42fd25493/Fig/ATRP_Kinetic_Simulator.svg" width="300">
</center>
<div id="cell-28" class="cell" data-tags="[&quot;hide_code&quot;]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#@title { display-mode: "form" }</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>copyright <span class="op">=</span> requests.get(<span class="st">"https://raw.githubusercontent.com/wangyu16/PolymerScienceEducation/master/copyright.md"</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>Markdown(copyright.text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="1">
<p>### Copyright</p>
<p>This software is designed for polymer science education. Copyright (C) 2021 Yu Wang</p>
<p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.<br>
This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.<br>
You should have received a copy of the GNU General Public License along with this program. If not, see https://www.gnu.org/licenses/.</p>
<section id="contact" class="level3">
<h3 class="anchored" data-anchor-id="contact">Contact</h3>
<p>Dr.&nbsp;Yu Wang<br>
Department of Chemistry<br>
Institute for Materials Research and Innovation<br>
University of Louisiana at Lafayette<br>
Lafayette, LA 70504<br>
Email: yuwang@louisiana.edu</p>
</section>
<section id="acknowledgement" class="level3">
<h3 class="anchored" data-anchor-id="acknowledgement">Acknowledgement</h3>
<p>This project is sponsored by National Science Foundation (NSF-2142043).</p>
</section>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>